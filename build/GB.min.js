var GB=function(e){function t(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){t.version="0.0.1",t.graph=i(1),t.view=i(2),t.model=i(3),t.nodeType=i(4),t.events=i(5)},function(e,t){"use strict";e.exports=function(e){function t(){requestAnimationFrame(t),s.view.controls.update(),i()}function i(){s.model.data.nodes.forEach(function(e){var t=s.view.scene.getObjectById(e.data.nodeId,!0);t&&(t.position.x=n(e.x),t.position.y=o(e.y))}),s.model.data.links.forEach(function(e){var t=s.view.scene.getObjectById(e.linkId,!0),i=new THREE.Vector3(n(e.target.x),o(e.target.y),0),r=new THREE.Vector3(n(e.source.x),o(e.source.y),0);t.setPos(i,r)}),s.view.raycaster.setFromCamera(s.view.mouse,s.view.camera),s.intersect.node=s.view.raycaster.intersectObjects(s.view.nodes.children)[0],s.view.composer.render(),s.hud&&s.view.renderer.render(s.hud.scene,s.hud.camera)}function n(e){return e-s.view.width/2}function o(e){return-(e-s.view.height/2)}var s={start:t,view:new GB.view(e.element),nodes:e.nodes,config:e.config||{},intersect:{node:[]},clicked:{last:null,prev:null}};return s.model=new GB.model(null,s),s.events=new GB.events(e.element,s,e.events),s}},function(e,t){e.exports=function(e){this.width=e.clientWidth,this.height=e.clientHeight,this.scene=new THREE.Scene,this.camera=new THREE.OrthographicCamera(-this.width/2,this.width/2,this.height/2,-this.height/2,0,15),this.camera.position.z=10,this.camera.zoom=4,this.camera.updateProjectionMatrix(),this.renderer=new THREE.WebGLRenderer({antialias:!1,alpha:!0}),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(this.width,this.height),this.renderer.autoClear=!1;var t=new THREE.RenderPass(this.scene,this.camera),i=new THREE.BloomPass(1),n=new THREE.ShaderPass(THREE.CopyShader),o=new THREE.ShaderPass(THREE.FXAAShader);o.uniforms.resolution.value.set(1/this.width,1/this.height),n.renderToScreen=!0,this.composer=new THREE.EffectComposer(this.renderer),this.composer.setSize(this.width,this.height),this.composer.addPass(t),this.composer.addPass(o),this.composer.addPass(i),this.composer.addPass(n),this.raycaster=new THREE.Raycaster,this.mouse=new THREE.Vector2,this.nodes=new THREE.Object3D,this.links=new THREE.Object3D,this.links.position.z=4,this.nodes.position.z=6,this.scene.add(this.nodes),this.scene.add(this.links),this.controls=new THREE.OrbitControls(this.camera,this.renderer.domElement),this.controls.mouseButtons={ORBIT:null,ZOOM:null,PAN:THREE.MOUSE.LEFT},this.controls.minZoom=.5,this.controls.maxZoom=10,e.appendChild(this.renderer.domElement)}},function(e,t){e.exports=function(e,t){this.data=e||{nodes:[],links:[]},this.force=d3.layout.force().nodes(this.data.nodes).links(this.data.links).gravity(.002).charge(-100).linkDistance(35).size([t.view.width,t.view.height]).start(),this.addNode=function(e,i,n,o,s){if(!this.findNode(e)){n=n?n:"default";var r=new THREE.Sprite(new THREE.SpriteMaterial(t.nodes[n].material));r._type=n,r._id=e,t.view.nodes.add(r),i.nodeId=r.id,i.type=n,this.data.nodes.push({id:e,data:i,fixed:o||!1,x:s?s.x:void 0,y:s?s.y:void 0}),t.view.controls.dispatchEvent({type:"change"}),this.force.start()}},this.addLink=function(e,i,n){for(var o=0;o<this.data.links.length;o++)if(this.data.links[o].source.id===e&&this.data.links[o].target.id===i)return;var s=new THREE.CustomArrowHelper(new THREE.Vector3(100,0,0),new THREE.Vector3(0,0,0),1,8769279);t.view.links.add(s),this.data.links.push({source:this.findNode(e),target:this.findNode(i),value:n,linkId:s.id}),this.force.start()},this.findNode=function(e){for(var t in this.data.nodes)if(this.data.nodes[t].id===e)return this.data.nodes[t]},this.removeNode=function(e){var i=0,n=this.findNode(e);for(t.view.nodes.remove(t.view.nodes.getObjectById(n.data.nodeId,!0));i<this.data.links.length;)this.data.links[i].source.id===e||this.data.links[i].target.id===e?(t.view.links.remove(t.view.links.getObjectById(this.data.links[i].linkId,!0)),this.data.links.splice(i,1)):i++;this.data.nodes.splice(this.findNodeIndex(e),1),this.force.start()},this.findNodeIndex=function(e){for(var t=0;t<this.data.nodes.length;t++)if(this.data.nodes[t].id==e)return t},this.allNodeLinks=function(e){var t=[];return this.data.links.forEach(function(i){i.source.id==e?t.push(i.target.id):i.target.id==e&&t.push(i.source.id)}),t}}},function(e,t){e.exports=function(e){var t=new THREE.TextureLoader;this.material={map:t.load(e.material.texture)||null,color:e.material.color||null,rotation:e.material.rotation||null,fog:e.material.fog||null},this.startScale=e.material.scale,this.draggable=void 0===e.draggable?!0:e.draggable,this.events=e.events||{}}},function(e,t){e.exports=function(e,t,i){function n(e,t,n,o){i&&i[t]&&(n&&o?i[t](e,n,o):i[t](e))}function o(e,i,o){var s=void 0!==o?o:t.intersect.node?t.intersect.node.object:void 0;if(s){var r=t.nodes[s._type].events,d=r[i],a=t.model.findNode(s._id);n(e,i,a,s),d&&d(e,a,s)}}var s;this.mouseMove=function(i){return i.preventDefault(),t.view.mouse.x=i.clientX/e.clientWidth*2-1,t.view.mouse.y=2*-(i.clientY/e.clientHeight)+1,t.view.controls.enabled?void(t.intersect.node?(s?s!==t.intersect.node.object&&(o(i,"mouseout",s),s=null):(s=t.intersect.node.object,o(i,"mouseover",s)),o(i,"mousemove")):s&&(o(i,"mouseout",s),s=null)):(t.view.controls.drag.fixed=!0,t.view.controls.drag.dragged=!0,t.view.controls.drag.px=t.view.raycaster.ray.origin.x+t.view.width/2,t.view.controls.drag.py=-(t.view.raycaster.ray.origin.y-t.view.height/2),t.model.force.start(),void o(i,"mousemove",s))},this.mouseDown=function(e){0===e.button&&(e.preventDefault(),t.intersect.node&&t.nodes[t.intersect.node.object._type].draggable&&(t.view.controls.enabled=!1,t.view.controls.drag=t.model.findNode(t.intersect.node.object._id),t.view.controls.drag.dragged=!1))},this.mouseUp=function(e){0===e.button&&(e.preventDefault(),t.view.controls.enabled=!0,t.intersect.node?(t.clicked.prev=t.clicked.last,t.clicked.last=t.intersect.node.object):(n(e,"emptyClick"),t.clicked.last=null),t.view.controls.drag&&(t.view.controls.drag.dragged||o(e,"click"),t.view.controls.drag.dragged=!1))},this.dblclick=function(e){o(e,"dblclick")},this.contextmenu=function(e){o(e,"contextmenu")},this.controlsChanged=function(e){t.config.updateNodeScale&&t.view.nodes.children.forEach(function(e){var i=t.view.controls.maxZoom-t.view.camera.zoom+t.nodes[e._type].startScale;e.scale.set(i,i,1)}),n(e,"controlsChanged")},this.resize=function(i){t.view.width=e.clientWidth,t.view.height=e.clientHeight,t.view.renderer.setSize(t.view.width,t.view.height),t.view.composer.setSize(t.view.width,t.view.height),t.view.camera.left=t.view.width/-2,t.view.camera.right=t.view.width/2,t.view.camera.top=t.view.height/2,t.view.camera.bottom=t.view.height/-2,t.view.camera.updateProjectionMatrix()},e.addEventListener("mousemove",this.mouseMove,!1),e.addEventListener("mousedown",this.mouseDown,!1),e.addEventListener("mouseup",this.mouseUp,!1),e.addEventListener("dblclick",this.dblclick,!1),e.addEventListener("contextmenu",this.contextmenu,!1),t.view.controls.addEventListener("change",this.controlsChanged)}}]);
//# sourceMappingURL=GB.min.js.map